<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lychee App Presentation v2</title>
    <style>
        /* --- åŸºç¡€æ ·å¼ --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Arial, sans-serif; }
        body { background-color: #2c2c2c; display: flex; justify-content: center; align-items: center; min-height: 100vh; color: #333; }
        
        /* --- æ‰‹æœºå¤–å£³æ¨¡æ‹Ÿ --- */
        #phone-frame {
            width: 375px; height: 812px;
            background-color: #fff;
            border-radius: 40px;
            box-shadow: 0 0 0 10px #000, 0 0 0 12px #333, 0 30px 60px rgba(0,0,0,0.4);
            position: relative; overflow: hidden;
        }
        
        /* --- é€šç”¨ç»„ä»¶ --- */
        .status-bar { height: 44px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; font-size: 14px; font-weight: 600; z-index: 1000; position: absolute; top: 0; width: 100%; pointer-events: none; mix-blend-mode: difference; color: #fff; }
        .screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #fff; display: none; flex-direction: column; overflow-y: auto; overflow-x: hidden; }
        .screen.active { display: flex; animation: fadeIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .screen.sub-page { z-index: 200; background: #f9f9f9; }

        @keyframes fadeIn { from { opacity: 0.8; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* æŒ‰é’®ä¸äº¤äº’ */
        .btn { width: 100%; padding: 16px; border-radius: 14px; border: none; font-size: 16px; font-weight: 600; cursor: pointer; text-align: center; transition: transform 0.1s; }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background-color: #007AFF; color: white; box-shadow: 0 4px 12px rgba(0,122,255,0.3); }
        .btn-text { background: transparent; color: #666; font-size: 14px; margin-top: 15px; }
        .header { height: 60px; display: flex; align-items: center; padding: 0 20px; background: #fff; position: sticky; top: 0; z-index: 10; border-bottom: 0.5px solid #eee; margin-top: 44px; }
        .header-title { flex: 1; text-align: center; font-weight: bold; font-size: 17px; }
        .back-icon { font-size: 24px; width: 40px; cursor: pointer; }

        /* --- 1. Onboarding (5é¡µæ•™ç¨‹) --- */
        .onboard-screen { background-size: cover; background-position: center; justify-content: flex-end; padding-bottom: 50px; }
        .onboard-overlay { background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); padding: 40px 24px; color: white; border-radius: 30px 30px 0 0; }
        .ob-title { font-size: 28px; margin-bottom: 10px; line-height: 1.2; }
        .ob-desc { font-size: 15px; opacity: 0.8; margin-bottom: 30px; line-height: 1.5; }
        .step-indicator { display: flex; gap: 6px; margin-bottom: 20px; }
        .step { width: 6px; height: 6px; background: rgba(255,255,255,0.3); border-radius: 50%; }
        .step.active { background: #007AFF; width: 20px; border-radius: 4px; }

        /* --- 2. Login --- */
        .login-container { padding: 40px 30px; display: flex; flex-direction: column; height: 100%; justify-content: center; margin-top: -40px; }
        .social-btn { display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 16px; border: 1px solid #eee; background: #fff; color: #333; }
        
        /* --- Tab Bar --- */
        .tab-bar { height: 84px; background: #fff; border-top: 0.5px solid #e0e0e0; display: flex; justify-content: space-around; align-items: flex-start; padding-top: 10px; position: absolute; bottom: 0; width: 100%; z-index: 99; }
        .tab-item { display: flex; flex-direction: column; align-items: center; width: 25%; cursor: pointer; color: #999; }
        .tab-item.active { color: #007AFF; }
        .tab-icon { font-size: 24px; margin-bottom: 4px; }
        .tab-text { font-size: 10px; font-weight: 500; }

        /* --- Chat List --- */
        .chat-list { padding: 0 0 100px; }
        .chat-item { display: flex; padding: 16px 20px; border-bottom: 0.5px solid #f0f0f0; align-items: center; gap: 14px; cursor: pointer; }
        .chat-avatar { width: 50px; height: 50px; border-radius: 50%; background: #eee; position: relative; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .badge { position: absolute; top: -2px; right: -2px; background: #ff3b30; color: white; font-size: 10px; padding: 2px 6px; border-radius: 10px; border: 2px solid #fff; }
        .chat-content { flex: 1; }
        .chat-name { font-weight: 600; font-size: 15px; margin-bottom: 4px; }
        .chat-msg { color: #888; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 240px; }
        .chat-time { font-size: 11px; color: #bbb; align-self: flex-start; margin-top: 4px; }

        /* --- Chat Room UI (New) --- */
        .chat-room-body { flex: 1; background: #f5f5f5; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; padding-bottom: 80px; }
        .msg-row { display: flex; align-items: flex-end; gap: 8px; }
        .msg-row.me { justify-content: flex-end; }
        .msg-bubble { max-width: 70%; padding: 10px 14px; border-radius: 16px; font-size: 14px; line-height: 1.4; position: relative; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .msg-left { background: #fff; color: #333; border-bottom-left-radius: 4px; }
        .msg-right { background: #007AFF; color: #fff; border-bottom-right-radius: 4px; }
        .msg-time { font-size: 10px; color: #999; margin-bottom: 2px; }
        
        .chat-input-bar { position: absolute; bottom: 0; width: 100%; background: #fff; border-top: 1px solid #e0e0e0; padding: 10px 15px; display: flex; align-items: center; gap: 10px; height: 60px; padding-bottom: max(10px, env(safe-area-inset-bottom)); }
        .chat-input { flex: 1; height: 36px; border: 1px solid #ddd; border-radius: 18px; padding: 0 15px; font-size: 14px; outline: none; background: #f9f9f9; }
        .chat-input:focus { border-color: #007AFF; background: #fff; }
        .chat-send-btn { width: 36px; height: 36px; border-radius: 50%; background: #007AFF; color: white; border: none; font-size: 18px; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* --- Other Styles (Feed, MyPage, etc) --- */
        .feed-container { padding: 10px 16px 100px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 0; }
        .feed-card { background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .feed-img { width: 100%; height: auto; display: block; background: #eee; }
        .feed-info { padding: 10px; }
        .feed-title { font-size: 13px; font-weight: 600; margin-bottom: 6px; }
        .profile-header { padding: 20px 20px 30px; background: #fff; display: flex; align-items: center; gap: 16px; margin-top: 44px; }
        .profile-avatar { width: 70px; height: 70px; border-radius: 50%; background-color: #ddd; background-size: cover; background-position: center; }
        .menu-group { margin-top: 10px; background: #fff; padding: 0 20px; }
        .menu-row { display: flex; justify-content: space-between; padding: 18px 0; border-bottom: 0.5px solid #eee; font-size: 15px; cursor: pointer; }
        .banner { height: 140px; background: #f0f0f0; border-radius: 12px; margin: 10px 20px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px; background-image: url('https://placehold.co/600x300/e1f5fe/007aff?text=Seoul+Special+Offer'); background-size: cover; }
        .cat-scroll { display: flex; overflow-x: auto; padding: 0 20px 10px; gap: 15px; scrollbar-width: none; }
        .cat-item { min-width: 60px; height: 60px; background: #f2f2f7; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; flex-direction: column; gap: 4px; }
        .section-h { font-size: 18px; font-weight: 700; margin: 20px 20px 10px; }
        .h-scroll { display: flex; overflow-x: auto; gap: 15px; padding: 0 20px 80px; }
        .p-card { min-width: 140px; width: 140px; }
        .p-img { width: 140px; height: 140px; border-radius: 12px; background: #eee; object-fit: cover; }
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

<div id="phone-frame">
    <div class="status-bar">
        <span>9:41</span>
        <span>ğŸ“¶ 5G &nbsp; ğŸ”‹ 100%</span>
    </div>

    <div id="ob-1" class="screen active onboard-screen" style="background-image: url('https://placehold.co/375x812/ffe0b2/e65100?text=Image:Warm+Cake');">
        <div class="onboard-overlay">
            <div class="step-indicator"><div class="step active"></div><div class="step"></div><div class="step"></div><div class="step"></div><div class="step"></div></div>
            <div class="ob-title">è¿æ¥ä½ çš„<br>éŸ©å›½å¿ƒæ„</div>
            <div class="ob-desc">Lychee ä¸ºæ‚¨ç²¾é€‰é¦–å°”æœ€å¥½çš„è›‹ç³•ä¸é²œèŠ±ï¼Œè®©çˆ±è·¨è¶Šå›½ç•Œã€‚</div>
            <button class="btn btn-primary" onclick="nextOb('ob-2')">ä¸‹ä¸€é¡µ</button>
        </div>
    </div>
    <div id="ob-2" class="screen onboard-screen" style="background-image: url('https://placehold.co/375x812/e1f5fe/0277bd?text=Image:Discovery');">
        <div class="onboard-overlay">
            <div class="step-indicator"><div class="step"></div><div class="step active"></div><div class="step"></div><div class="step"></div><div class="step"></div></div>
            <div class="ob-title">æ¢ç´¢ä¸å‘ç°<br>æœ¬åœ°æ½®æµ</div>
            <div class="ob-desc">åƒåˆ·å°çº¢ä¹¦ä¸€æ ·æµè§ˆéŸ©å›½æœ¬åœ°çƒ­é—¨åº—é“ºï¼Œå®æ—¶æŒæ¡ INS æµè¡Œè¶‹åŠ¿ã€‚</div>
            <button class="btn btn-primary" onclick="nextOb('ob-3')">ä¸‹ä¸€é¡µ</button>
        </div>
    </div>
    <div id="ob-3" class="screen onboard-screen" style="background-image: url('https://placehold.co/375x812/f3e5f5/7b1fa2?text=Image:Customization');">
        <div class="onboard-overlay">
            <div class="step-indicator"><div class="step"></div><div class="step"></div><div class="step active"></div><div class="step"></div><div class="step"></div></div>
            <div class="ob-title">ä¸“å±å®šåˆ¶<br>éšå¿ƒé¢„è®¢</div>
            <div class="ob-desc">æ”¯æŒä¸­æ–‡å¡«å†™åˆ»å­—å†…å®¹ï¼Œè‡ªåŠ¨ç¿»è¯‘ç»™å•†å®¶ï¼Œè¯­è¨€ä¸å†æ˜¯éšœç¢ã€‚</div>
            <button class="btn btn-primary" onclick="nextOb('ob-4')">ä¸‹ä¸€é¡µ</button>
        </div>
    </div>
    <div id="ob-4" class="screen onboard-screen" style="background-image: url('https://placehold.co/375x812/e0f2f1/00695c?text=Image:Delivery');">
        <div class="onboard-overlay">
            <div class="step-indicator"><div class="step"></div><div class="step"></div><div class="step"></div><div class="step active"></div><div class="step"></div></div>
            <div class="ob-title">å‡†æ—¶é€è¾¾<br>å®æ—¶è¿½è¸ª</div>
            <div class="ob-desc">ç›´è¿ Kakao T éª‘æ‰‹ï¼Œåœ°å›¾å®æ—¶æŸ¥çœ‹é…é€è¿›åº¦ï¼Œå®‰å¿ƒç›´è¾¾é…’åº—ã€‚</div>
            <button class="btn btn-primary" onclick="nextOb('ob-5')">ä¸‹ä¸€é¡µ</button>
        </div>
    </div>
    <div id="ob-5" class="screen onboard-screen" style="background-image: url('https://placehold.co/375x812/fff3e0/ff6f00?text=Image:Payment');">
        <div class="onboard-overlay">
            <div class="step-indicator"><div class="step"></div><div class="step"></div><div class="step"></div><div class="step"></div><div class="step active"></div></div>
            <div class="ob-title">ä¾¿æ·æ”¯ä»˜<br>å®‰å…¨æ— å¿§</div>
            <div class="ob-desc">æ”¯æŒå¾®ä¿¡æ”¯ä»˜ã€æ”¯ä»˜å®ç›´æ¥ç»“ç®—ã€‚å‡†å¤‡å¥½å¼€å§‹äº†å—ï¼Ÿ</div>
            <button class="btn btn-primary" onclick="showScreen('screen-login')">è¿›å…¥ Lychee</button>
        </div>
    </div>

    <div id="screen-login" class="screen">
        <div class="login-container">
            <div style="font-size: 50px; margin-bottom: 20px; color: #007AFF; font-weight: bold;">Ly.</div>
            <h1 style="margin-bottom: 10px;">æ¬¢è¿å›æ¥</h1>
            <p style="color: #666; margin-bottom: 50px;">ç™»å½•ä»¥å¼€å§‹æ‚¨çš„ç”œèœœæ—…ç¨‹</p>
            <button class="btn social-btn" onclick="login()">
                <span style="color:#07C160; font-weight:bold;">ğŸ’¬</span> å¾®ä¿¡ä¸€é”®ç™»å½•
            </button>
            <button class="btn social-btn" style="background:#FEE500; border:none;" onclick="login()">
                <span style="font-weight:bold;">K</span> Kakao Login
            </button>
            <div style="text-align: center; margin: 30px 0; color: #ccc;">- æˆ– -</div>
            <button class="btn btn-primary" style="background: #333;" onclick="login(true)">æ¸¸å®¢è¯•ç”¨ (Guest Mode)</button>
        </div>
    </div>

    <div id="tab-home" class="screen">
        <div class="header">
            <div class="header-title" style="text-align: left; font-size: 22px; color: #007AFF;">Lychee</div>
            <div style="background: #f2f2f7; padding: 8px 12px; border-radius: 20px; font-size: 12px; color: #666; width: 140px;">ğŸ” æœç´¢è›‹ç³•/é²œèŠ±</div>
        </div>
        <div class="banner">æœ¬å‘¨é¦–å°”å¿…åƒæ¦œå• TOP 10 ></div>
        <div class="cat-scroll">
            <div class="cat-item"><span>ğŸ°</span><span style="font-size:10px;color:#333;">è›‹ç³•</span></div>
            <div class="cat-item"><span>ğŸ’</span><span style="font-size:10px;color:#333;">é²œèŠ±</span></div>
            <div class="cat-item"><span>ğŸ</span><span style="font-size:10px;color:#333;">ä¼´æ‰‹ç¤¼</span></div>
        </div>
        <div class="section-h">äººæ°”å•†å®¶</div>
        <div class="h-scroll">
            <div class="p-card" onclick="goToDetail()">
                <img src="https://placehold.co/140x140/e1f5fe/007AFF?text=Piugo" class="p-img">
                <div style="font-size: 13px; font-weight: 600; margin-top: 5px;">Piugo Flower</div>
                <div style="font-size: 10px; color: #999;">å¼˜å¤§ Â· é²œèŠ±å®šåˆ¶</div>
            </div>
            <div class="p-card" onclick="goToDetail()">
                <img src="https://placehold.co/140x140/fff3e0/e65100?text=Cream" class="p-img">
                <div style="font-size: 13px; font-weight: 600; margin-top: 5px;">CreamLabel</div>
                <div style="font-size: 10px; color: #999;">åœ£æ°´æ´ Â· è›‹ç³•</div>
            </div>
        </div>
        <div class="section-h">çƒ­é—¨å•†å“</div>
        <div class="h-scroll">
            <div class="p-card" onclick="goToDetail()">
                <img src="https://placehold.co/140x180/f3e5f5/7b1fa2?text=Cake" class="p-img">
                <div style="font-size: 13px; font-weight: 600; margin-top: 5px;">å¤å¤åˆ»å­—è›‹ç³•</div>
                <div style="font-size: 12px; color: #007AFF; font-weight: bold;">â‚© 58,000</div>
            </div>
        </div>
    </div>

    <div id="tab-feed" class="screen">
        <div class="header">
            <div class="header-title">å‘ç°</div>
        </div>
        <div class="feed-container">
            <div class="feed-card">
                <img src="https://placehold.co/160x200/ffe0b2/e65100?text=Review+1" class="feed-img">
                <div class="feed-info">
                    <div class="feed-title">è¿™å®¶è›‹ç³•çœŸçš„ç»äº†ï¼å¦‚æœä¸é¢„çº¦æ ¹æœ¬åƒä¸åˆ°...</div>
                    <div style="font-size:11px;color:#888;">â¤ï¸ 128</div>
                </div>
            </div>
            <div class="feed-card">
                <img src="https://placehold.co/160x160/e1f5fe/0277bd?text=Review+2" class="feed-img">
                <div class="feed-info">
                    <div class="feed-title">é€ç»™ç”·æœ‹å‹çš„ç”Ÿæ—¥æƒŠå–œï¼Œé…é€è¶…çº§å¿«</div>
                    <div style="font-size:11px;color:#888;">â¤ï¸ 56</div>
                </div>
            </div>
        </div>
    </div>

    <div id="tab-chat" class="screen">
        <div class="header">
            <div class="header-title">æ¶ˆæ¯</div>
        </div>
        <div class="chat-list">
            <div class="chat-item" onclick="openChat('mumudaebake é¦–å°”åº—', 'ğŸ¥¨')">
                <div class="chat-avatar" style="background: #fff3e0;">
                    <span>ğŸ¥¨</span>
                    <div class="badge">1</div>
                </div>
                <div class="chat-content">
                    <div class="chat-name">mumudaebake é¦–å°”åº—</div>
                    <div class="chat-msg">æ‚¨å¥½ï¼Œå¤šä¹°ä¸€æ ¹èœ¡çƒ›çš„è¯éœ€è¦åŠ  2000éŸ©å…ƒå“¦</div>
                </div>
                <div class="chat-time">14:20</div>
            </div>
            <div class="chat-item" onclick="showScreen('screen-delivery')">
                <div class="chat-avatar" style="background: #e3f2fd;">
                    <span>ğŸ””</span>
                </div>
                <div class="chat-content">
                    <div class="chat-name">è®¢å•çŠ¶æ€é€šçŸ¥</div>
                    <div class="chat-msg">æ‚¨çš„è®¢å• #20231126 å·²è¢«éª‘æ‰‹æ¥å•ï¼Œç‚¹å‡»æŸ¥çœ‹ä½ç½®</div>
                </div>
                <div class="chat-time">æ˜¨å¤©</div>
            </div>
            <div class="chat-item" onclick="openChat('é—ºèœœå°å¼ ', 'ğŸ‘©')">
                <div class="chat-avatar" style="background:#eee;">ğŸ‘©</div>
                <div class="chat-content">
                    <div class="chat-name">é—ºèœœå°å¼ </div>
                    <div class="chat-msg">é‚£å®¶è¿˜ä¸é”™ï¼Œæˆ‘ä¹Ÿæƒ³è®¢</div>
                </div>
                <div class="chat-time">å‘¨ä¸€</div>
            </div>
        </div>
    </div>

    <div id="tab-my" class="screen">
        <div class="profile-header">
            <div id="my-avatar" class="profile-avatar" style="background-image: url('https://placehold.co/100x100/333/fff?text=User');"></div>
            <div style="flex: 1;">
                <h2 id="username-display" style="font-size: 20px; margin-bottom: 4px;">å¾®ä¿¡ç”¨æˆ·_Lychee</h2>
                <div style="font-size: 12px; color: #888;">ID: 8829103 â€¢ æ™®é€šä¼šå‘˜</div>
            </div>
            <div style="padding: 8px; background: #f2f2f7; border-radius: 50%; cursor: pointer;" onclick="openSubPage('screen-settings')">âš™ï¸</div>
        </div>
        <div class="menu-group">
            <div class="menu-row" onclick="openSubPage('screen-address')">
                <span>ğŸ“ åœ°å€ç®¡ç†</span> <span>></span>
            </div>
            <div class="menu-row">
                <span>ğŸ« ä¼˜æƒ åˆ¸</span> <span>></span>
            </div>
        </div>
        <button class="btn btn-text" onclick="showScreen('screen-login')">é€€å‡ºç™»å½•</button>
    </div>

    <div id="screen-settings" class="screen sub-page">
        <div class="header"><div class="back-icon" onclick="closeSubPage('screen-settings')">â†</div><div class="header-title">ä¸ªäººè®¾ç½®</div><div style="width:40px;"></div></div>
        <div style="padding:20px;display:grid;grid-template-columns:repeat(4,1fr);gap:15px;">
            <div style="width:60px;height:60px;background:#eee;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:30px;" onclick="changeAvatar(this,'ğŸ¶')">ğŸ¶</div>
            <div style="width:60px;height:60px;background:#eee;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:30px;" onclick="changeAvatar(this,'ğŸ±')">ğŸ±</div>
        </div>
    </div>

    <div id="screen-address" class="screen sub-page">
        <div class="header"><div class="back-icon" onclick="closeSubPage('screen-address')">â†</div><div class="header-title">åœ°å€ç®¡ç†</div><div style="width:40px;font-size:24px;cursor:pointer;" onclick="addAddressMock()">+</div></div>
        <div style="padding:20px;" id="addr-list">
            <div style="background:#fff;padding:15px;border-radius:12px;margin-bottom:12px;border:1px solid #eee;">
                <div style="font-weight:bold;margin-bottom:6px;">L7 Hongdae Hotel <span style="background:#e3f2fd;color:#007AFF;font-size:10px;padding:2px 6px;border-radius:4px;">é»˜è®¤</span></div>
                <div style="font-size:13px;color:#666;">Mapo-gu, Yanghwa-ro 141</div>
            </div>
        </div>
    </div>

    <div id="screen-detail" class="screen sub-page">
        <div style="position:relative;"><img src="https://placehold.co/375x375/e1f5fe/007aff?text=Product" style="width:100%;"><div class="back-icon" style="position:absolute;top:50px;left:20px;background:rgba(255,255,255,0.8);border-radius:50%;text-align:center;line-height:40px;" onclick="closeSubPage('screen-detail')">â†</div></div>
        <div style="padding:20px;background:#fff;border-radius:20px 20px 0 0;margin-top:-30px;position:relative;">
            <h1 style="font-size:24px;">å¤å¤åˆ»å­—è›‹ç³•</h1>
            <div style="color:#007AFF;font-size:22px;font-weight:bold;margin:10px 0;">â‚© 58,000</div>
            <div style="height:100px;"></div>
        </div>
        <div style="position:fixed;bottom:0;width:100%;padding:20px;background:#fff;border-top:1px solid #eee;display:flex;gap:10px;">
            <button class="btn btn-primary" style="flex:1;" onclick="openSubPage('screen-payment')">ç«‹å³é¢„è®¢</button>
        </div>
    </div>

    <div id="screen-payment" class="screen sub-page">
        <div class="header"><div class="back-icon" onclick="closeSubPage('screen-payment')">â†</div><div class="header-title">æ”¶é“¶å°</div><div style="width:40px;"></div></div>
        <div style="padding:40px 20px;text-align:center;">
            <div style="font-size:36px;font-weight:bold;">â‚© 63,000</div>
            <button class="btn btn-primary" style="margin-top:40px;" onclick="processPayment()">ç¡®è®¤æ”¯ä»˜</button>
        </div>
    </div>

    <div id="screen-delivery" class="screen sub-page">
        <div class="header"><div class="back-icon" onclick="closeSubPage('screen-delivery')">âœ•</div><div class="header-title">é…é€è¿½è¸ª</div><div style="width:40px;"></div></div>
        <div style="flex:1;background:#e0e0e0;display:flex;align-items:center;justify-content:center;position:relative;">
            <div style="font-size:20px;color:#666;">[ Map Mockup ]</div>
            <div style="position:absolute;top:40%;left:60%;background:#fff;padding:5px;border-radius:50%;font-size:24px;">ğŸ›µ</div>
        </div>
        <div style="background:#fff;padding:20px;border-radius:20px 20px 0 0;">
            <div style="font-weight:bold;font-size:18px;">é¢„è®¡ 10åˆ†é’Ÿå é€è¾¾</div>
        </div>
    </div>

    <div id="screen-chat-room" class="screen sub-page">
        <div class="header">
            <div class="back-icon" onclick="closeSubPage('screen-chat-room')">â†</div>
            <div class="header-title" id="chat-room-title">å•†å®¶åç§°</div>
            <div style="width: 40px; font-size: 20px; text-align: center;">â‹¯</div>
        </div>
        
        <div class="chat-room-body" id="chat-history">
            <div style="text-align: center; color: #ccc; font-size: 12px; margin: 10px 0;">æ˜¨å¤© 14:00</div>
            
            <div class="msg-row">
                <div class="chat-avatar" style="width: 36px; height: 36px; font-size: 18px; background: #fff3e0;" id="chat-room-avatar">ğŸ¥¨</div>
                <div class="msg-bubble msg-left">
                    æ‚¨å¥½ï¼Œæ¬¢è¿å…‰ä¸´ mumudaebakeï¼è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ
                </div>
            </div>

            <div class="msg-row me">
                <div class="msg-bubble msg-right">
                    è¯·é—®å¦‚æœæˆ‘æƒ³å¤šåŠ ä¸€æ ¹èœ¡çƒ›ï¼Œéœ€è¦é¢å¤–ä»˜è´¹å—ï¼Ÿ
                </div>
            </div>

            <div class="msg-row">
                <div class="chat-avatar" style="width: 36px; height: 36px; font-size: 18px; background: #fff3e0;">ğŸ¥¨</div>
                <div class="msg-bubble msg-left">
                    æ‚¨å¥½ï¼Œå¤šä¹°ä¸€æ ¹èœ¡çƒ›çš„è¯éœ€è¦åŠ  2000éŸ©å…ƒå“¦ã€‚
                </div>
            </div>
        </div>

        <div class="chat-input-bar">
            <input type="text" class="chat-input" id="chat-msg-input" placeholder="å‘é€æ¶ˆæ¯...">
            <button class="chat-send-btn" onclick="sendMessage()">â†‘</button>
        </div>
    </div>

    <div class="tab-bar" id="main-nav" style="display: none;">
        <div class="tab-item active" onclick="switchTab('tab-home', this)"><div class="tab-icon">ğŸ </div><div class="tab-text">ä¸»é¡µ</div></div>
        <div class="tab-item" onclick="switchTab('tab-feed', this)"><div class="tab-icon">ğŸ›ï¸</div><div class="tab-text">åŠ¨æ€</div></div>
        <div class="tab-item" onclick="switchTab('tab-chat', this)"><div class="tab-icon">ğŸ’¬</div><div class="tab-text">æ¶ˆæ¯</div></div>
        <div class="tab-item" onclick="switchTab('tab-my', this)"><div class="tab-icon">ğŸ‘¤</div><div class="tab-text">æˆ‘çš„</div></div>
    </div>
</div>

<script>
    /* --- æ ¸å¿ƒé€»è¾‘ --- */
    function nextOb(nextId) { document.querySelectorAll('.onboard-screen').forEach(el => el.classList.remove('active')); document.getElementById(nextId).classList.add('active'); }
    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(el => { if(!el.classList.contains('sub-page')) el.classList.remove('active'); });
        document.getElementById(id).classList.add('active');
        const nav = document.getElementById('main-nav');
        if(id.startsWith('tab-')) nav.style.display = 'flex'; else nav.style.display = 'none';
    }
    function openSubPage(id) { document.getElementById(id).classList.add('active'); }
    function closeSubPage(id) { document.getElementById(id).classList.remove('active'); }
    function login(isGuest) {
        if(isGuest) { document.getElementById('username-display').innerText = "æ¸¸å®¢ (Guest)"; document.getElementById('my-avatar').style.backgroundImage = "url('https://placehold.co/100x100/eee/999?text=Guest')"; }
        setTimeout(() => { switchTab('tab-home', document.querySelectorAll('.tab-item')[0]); }, 500);
    }
    function switchTab(screenId, element) { showScreen(screenId); document.querySelectorAll('.tab-item').forEach(el => el.classList.remove('active')); if(element) element.classList.add('active'); }
    function goToDetail() { openSubPage('screen-detail'); }
    function processPayment() { 
        const btn = document.querySelector('#screen-payment .btn-primary'); 
        btn.innerText = "æ”¯ä»˜ä¸­..."; btn.style.background = "#ccc";
        setTimeout(() => { alert("æ”¯ä»˜æˆåŠŸï¼"); btn.innerText = "ç¡®è®¤æ”¯ä»˜"; btn.style.background = "#007AFF"; closeSubPage('screen-payment'); closeSubPage('screen-detail'); openSubPage('screen-delivery'); }, 1500); 
    }
    function changeAvatar(element, emoji) {
        document.getElementById('my-avatar').style.backgroundImage = 'none'; document.getElementById('my-avatar').style.backgroundColor = '#e3f2fd'; document.getElementById('my-avatar').innerText = emoji; 
        document.getElementById('my-avatar').style.display = 'flex'; document.getElementById('my-avatar').style.alignItems = 'center'; document.getElementById('my-avatar').style.justifyContent = 'center'; document.getElementById('my-avatar').style.fontSize = '30px';
        setTimeout(() => { closeSubPage('screen-settings'); }, 300);
    }
    function addAddressMock() { alert("æ·»åŠ åœ°å€ç•Œé¢æ¨¡æ‹Ÿ"); }

    /* --- Chat Logic (New) --- */
    let currentChatAvatar = 'ğŸ¥¨';

    function openChat(name, avatarEmoji) {
        document.getElementById('chat-room-title').innerText = name;
        currentChatAvatar = avatarEmoji;
        // æ›´æ–°èŠå¤©å®¤å†…çš„å¤´åƒ
        const avatars = document.querySelectorAll('#chat-room-avatar, .chat-room-body .msg-row:not(.me) .chat-avatar');
        avatars.forEach(el => el.innerText = avatarEmoji);
        
        openSubPage('screen-chat-room');
        scrollToBottom();
    }

    function sendMessage() {
        const input = document.getElementById('chat-msg-input');
        const text = input.value.trim();
        if(!text) return;

        // 1. æ·»åŠ â€œæˆ‘â€çš„æ¶ˆæ¯
        addMessageBubble(text, true);
        input.value = '';

        // 2. æ¨¡æ‹Ÿå¯¹æ–¹å›å¤ (1ç§’å)
        setTimeout(() => {
            const replies = ["å¥½çš„ï¼Œæ²¡é—®é¢˜ï¼", "ç¨ç­‰æˆ‘ç¡®è®¤ä¸€ä¸‹å“¦ã€‚", "æ”¶åˆ°ï¼Œè°¢è°¢æ‚¨çš„è®¢å•ï¼", "è¿™ä¸ªéœ€è¦å®šåˆ¶ï¼Œå¤§æ¦‚éœ€è¦2å°æ—¶ã€‚"];
            const randomReply = replies[Math.floor(Math.random() * replies.length)];
            addMessageBubble(randomReply, false);
        }, 1000);
    }

    function addMessageBubble(text, isMe) {
        const history = document.getElementById('chat-history');
        const msgRow = document.createElement('div');
        msgRow.className = isMe ? 'msg-row me' : 'msg-row';
        
        let html = '';
        if(!isMe) {
            html += `<div class="chat-avatar" style="width: 36px; height: 36px; font-size: 18px; background: #fff3e0;">${currentChatAvatar}</div>`;
        }
        
        const bubbleClass = isMe ? 'msg-right' : 'msg-left';
        html += `<div class="msg-bubble ${bubbleClass}">${text}</div>`;
        
        msgRow.innerHTML = html;
        history.appendChild(msgRow);
        scrollToBottom();
    }

    function scrollToBottom() {
        const history = document.getElementById('chat-history');
        history.scrollTop = history.scrollHeight;
    }
</script>
</body>
</html>
